{"version":3,"sources":["DataDisplay.js","CityData.js","App.js","index.js"],"names":["aqiThresholds","mugStart","CmugStart","linearIndex","thresholds","value","findIndex","threshold","linearStepwiseMapping","fro","to","diff","i","DataDisplay","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","status","color","data","_this2","fetch","city","then","response","json","Error","aqi","mug","iaqi","pm25","v","Math","round","caqi","mugToCAqi","setState","aqi25","aqicat","caqi25","caqicat","aqi10","pm10","localTime","Date","time","s","universalTime","tz","catch","error","react_default","a","createElement","toLocaleTimeString","className","React","Component","CityData","src_DataDisplay","App","id","src_CityData","ReactDOM","render","src_App","document","getElementById"],"mappings":"oMAGMA,EAAgB,CAAC,EAAG,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,KACjDC,EAAW,CAAC,EAAG,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,OACtDC,EAAY,CAAC,EAAG,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,OAE9D,SAASC,EAAYC,EAAYC,GAC/B,OAAOD,EAAWE,UAAU,SAAAC,GAAS,OAAIF,EAAQE,IAOnD,SAASC,EAAsBC,EAAKC,EAAIC,EAAMN,GAC5C,IAAMO,EAAIT,EAAYM,EAAKJ,GAC3B,OAAOK,EAAGE,EAAE,IAAMP,EAAQI,EAAIG,EAAE,KAAOF,EAAGE,GAAGD,EAAKD,EAAGE,EAAE,KAAOH,EAAIG,GAAKH,EAAIG,EAAE,QAgEhEC,cAhDb,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KACDQ,MAAQ,CACXC,OAAQ,qBACRC,MAAO,QACPC,KAAM,MALSV,mFASC,IAAAW,EAAAR,KAClBS,MAAM,8BAAgCT,KAAKJ,MAAMc,KAAO,oDACrDC,KAAK,SAAAC,GAAQ,OAAIA,EAASC,SAC1BF,KAAK,SAAAE,GACJ,GAAoB,OAAhBA,EAAKR,OAeP,MAAM,IAAIS,MAfc,IA1BhBC,EA2BAR,EAASM,EAATN,KACFS,GA5BED,EA4BaR,EAAKU,KAAKC,KAAKC,EA3BpCC,KAAKC,MAA+D,GAAzD/B,EAAsBR,EAAeC,EAAU,GAAKgC,IAAS,IA4BlEO,EArBhB,SAAmBN,GACjB,OAAOI,KAAKC,MAAM/B,EAAsBN,EAAWF,EAAe,EAAGkC,IAoBhDO,CAAUP,GACvBR,EAAKgB,SAAS,CAAEjB,KAAM,CACpBS,IAAKA,EACLS,MAAOlB,EAAKU,KAAKC,KAAKC,EACtBO,OAAQzC,EAAYH,EAAeyB,EAAKU,KAAKC,KAAKC,GAClDQ,OAAQL,EACRM,QAAS3C,EAAYH,EAAewC,GACpCO,MAAOtB,EAAKU,KAAKa,KAAKX,EACtBY,UAAW,IAAIC,KAAKzB,EAAK0B,KAAKC,GAC9BC,cAAe,IAAIH,KAAKzB,EAAK0B,KAAKC,EAAI3B,EAAK0B,KAAKG,SAKnDC,MAAM,SAAAC,GAAK,OAAI9B,EAAKgB,SAAS,CAAEnB,OAAQ,2DAGrC,IACCE,EAASP,KAAKI,MAAdG,KACR,OAAIA,EACOgC,EAAAC,EAAAC,cAAA,WACNlC,EAAKwB,UAAUW,qBADT,cACyCH,EAAAC,EAAAC,cAAA,WADzC,wBAEelC,EAAKS,IAFpB,WAE6BuB,EAAAC,EAAAC,cAAA,gBAAYF,EAAAC,EAAAC,cAAA,WAFzC,QAGFF,EAAAC,EAAAC,cAAA,QAAME,UAAW,MAAQpC,EAAKmB,QAASnB,EAAKkB,OAAac,EAAAC,EAAAC,cAAA,WAHvD,iBAIOF,EAAAC,EAAAC,cAAA,QAAME,UAAW,MAAQpC,EAAKqB,SAAUrB,EAAKoB,QAJpD,KAOF3B,KAAKI,MAAMC,cA5CEuC,IAAMC,WCdjBC,mLAbX,OACEP,EAAAC,EAAAC,cAAA,OAAKE,UAAU,YACbJ,EAAAC,EAAAC,cAAA,cACGzC,KAAKJ,MAAMc,MAEd6B,EAAAC,EAAAC,cAAA,eACEF,EAAAC,EAAAC,cAACM,EAAD,CAAarC,KAAMV,KAAKJ,MAAMc,gBARjBkC,IAAMC,WCWdG,MAVf,WACE,OACET,EAAAC,EAAAC,cAAA,OAAKQ,GAAG,WACNV,EAAAC,EAAAC,cAACS,EAAD,CAAUxC,KAAK,WACf6B,EAAAC,EAAAC,cAACS,EAAD,CAAUxC,KAAK,YACf6B,EAAAC,EAAAC,cAACS,EAAD,CAAUxC,KAAK,aCJrByC,IAASC,OAAOb,EAAAC,EAAAC,cAACY,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.639dd469.chunk.js","sourcesContent":["import React from 'react';\n\n// http://aqicn.org/faq/2013-09-09/revised-pm25-aqi-breakpoints/\nconst aqiThresholds = [0, 51, 101, 151, 201, 301, 401, 501];\nconst mugStart = [0, 12.1, 35.5, 55.6, 150.5, 250.5, 350.5, 500.1];\nconst CmugStart = [0, 35.1, 75.1, 115.1, 150.1, 250.1, 350.1, 500.1];\n\nfunction linearIndex(thresholds, value) {\n  return thresholds.findIndex(threshold => value < threshold);\n}\n\nfunction aqiIndex(aqi) {\n  return aqiThresholds.findIndex(threshold => aqi < threshold);\n}\n\nfunction linearStepwiseMapping(fro, to, diff, value) {\n  const i = linearIndex(fro, value);\n  return to[i-1] + (value - fro[i-1]) * (to[i]-diff-to[i-1]) / (fro[i] - fro[i-1]);\n}\n\nfunction aqiToMug(aqi) {\n  return (Math.round(linearStepwiseMapping(aqiThresholds, mugStart, 0.1, aqi)*10)/10);\n}\n\nfunction mugToAqi(mug) {\n  return Math.round(linearStepwiseMapping(mugStart, aqiThresholds, 0, mug));\n}\n\nfunction mugToCAqi(mug) {\n  return Math.round(linearStepwiseMapping(CmugStart, aqiThresholds, 0, mug));\n}\n\nclass DataDisplay extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: 'retrieving data...',\n      color: 'white',\n      data: null\n    }\n  }\n\n  componentDidMount() {\n    fetch('https://api.waqi.info/feed/' + this.props.city + '/?token=7ef04af09a2a93a67569a5c774a03c617e99103e')\n      .then(response => response.json())\n      .then(json => {\n        if (json.status === 'ok') {\n          const { data } = json;\n          const mug = aqiToMug(data.iaqi.pm25.v);\n          const caqi = mugToCAqi(mug);\n          this.setState({ data: {\n            mug: mug,\n            aqi25: data.iaqi.pm25.v,\n            aqicat: linearIndex(aqiThresholds, data.iaqi.pm25.v),\n            caqi25: caqi,\n            caqicat: linearIndex(aqiThresholds, caqi),\n            aqi10: data.iaqi.pm10.v,\n            localTime: new Date(data.time.s),\n            universalTime: new Date(data.time.s + data.time.tz),\n          }});\n        } else {\n          throw new Error();\n        }\n      }).catch(error => this.setState({ status: 'failed to load data' }));\n  }\n\n  render() {\n    const { data } = this.state;\n    if (data) {\n      return ( <div>\n        {data.localTime.toLocaleTimeString()} local time<br />\n        PM2.5 concentration: {data.mug} Âµg/m<sup>3</sup><br />\n        AQI: <span className={\"aqi\" + data.aqicat}>{data.aqi25}</span><br />\n        (Chinese AQI: <span className={\"aqi\" + data.caqicat}>{data.caqi25}</span>)\n      </div>);\n    } else {\n      return this.state.status;\n    }\n  }\n}\n\nexport default DataDisplay;\n","import React from 'react';\nimport DataDisplay from './DataDisplay.js';\n\nclass CityData extends React.Component {\n  render() {\n    return (\n      <div className=\"CityData\">\n        <header>\n          {this.props.city}\n        </header>\n        <content>\n          <DataDisplay city={this.props.city} />\n        </content>\n      </div>\n    );\n  }\n}\n\nexport default CityData;\n","import React from 'react';\nimport './App.css';\nimport CityData from './CityData.js';\n\nfunction App() {\n  return (\n    <div id=\"content\">\n      <CityData city=\"Vienna\" />\n      <CityData city=\"Kunming\" />\n      <CityData city=\"London\" />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n//import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n"],"sourceRoot":""}